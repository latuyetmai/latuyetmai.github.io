---
title: 'Lab 1: Are Democratic voters older or younger than Republican voters in 2020?'
author: "Catherine Tsai, Mai La"
output:
  pdf_document: default
  html_document:
    df_print: paged
---
```{r load packages, echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(haven)
library(knitr)
library(tidyr)
library(patchwork)
library(effsize)
```

```{r, include=FALSE}
# r setting
theme_set(theme_light())

knitr::opts_chunk$set(tidy.opts=list(width.cutoff=60), tidy = TRUE)
```

```{r, message=FALSE, warning=TRUE, include=FALSE}
##Save in a local folder
election <- read_dta("anes_timeseries_2020_stata_20210324.dta")
```

## Importance and Context

Democrats are commonly referred to as "progressive or liberals" while Republicans are commonly referred to as "conservatives." [Pew Research](https://www.pewresearch.org/fact-tank/2014/07/09/the-politics-of-american-generations-how-age-affects-attitudes-and-voting-behavior/) shows that political associations shift further from liberal towards conservative view points as age increases. 

Age is a factor in determining life stages. Example, a voter in their 20's will care very differently about Medicare coverage versus voters in the 80's will care very differently about student loan forgiveness and the policies each party will champion. Understanding voter age is important as it will give insight and inform decisions about what types of issues that will motivate voters to show up on Election day. Each party must strategically apply efforts to woo their target audience to impact the final outcome on game day (i.e. Election day). 

Population growth and changes can also determine the popularity of a party if the policies resonate with one group vs. another. Example, if population is shrinking, the overall population will age in futures years and would turn more supporters towards a party that attracts older populations. To understand demographic makeup of voters age and impact on politics, the study seeks to understand the following question: Are Democratic voters older or younger than Republican voters in 2020?

## Description of Data

```{r message=TRUE, include=FALSE}
## Remove non-voter data
# Non voter = people who did not register to vote, did not intend to register in pre-election
# and did not vote in the post-election data
# V201008 = 3 means R had not registered to vote in the pre election interview
# V201019 = 2 means R did not intend to register to vote in the pre election interview
# V202123 >= 1 means R did not vote in the post election data

election <- election %>%
  filter(!(V202123 >= 1 & V201008==3 & V201019 == 2))

# Initial sample size: 8280 
# Sample size after removing non-voter: 7985
nrow(election)
```

```{r, include=FALSE}
## Define Democratic voters & republican voters
# V201231x    PRE: SUMMARY: PARTY ID (including party registration & party lean data - pre election)
# V201231x = 1 - 3 means democrat: 1. Strong Democrat, 2. Not strong Democrat, 3. Lean-Democrat
# V201231x = 5 - 7 means republican: 5. Lean-Republican, 6.Not strong Republican, 7. Strong Republican
election <- election %>%
  mutate(
    party = case_when(
      election$V201231x >= 1 & election$V201231x <= 3 ~ 'Democrat',
      election$V201231x >= 5 & election$V201231x <= 7 ~ 'Republican',
      election$V201231x == 4 ~ 'Others')
    )

# Rename column Age
# V201507x  PRE: SUMMARY: RESPONDENT AGE
names(election)[names(election) == "V201507x"] <- "age"
```

```{r include=FALSE}
# Subset data: only include data for Democrat and Republican
# Only include actual age from 18 to 79. Exclude 80 & older group, exclude people who did not answer or NULL data
age_party <- election %>% 
  filter(party == "Democrat" | party == "Republican") %>%
  filter(age >= 18 & age <= 79)

# Sample size of subset data: 6490
nrow(age_party)
```

In order to answer the question, we will use data from the 2020 American National Election Studies (ANES). We define a voter using several survey questions pre and post election and exclude any records that indicate the person is a non voter in the 2020 Election (i.e. not registered to vote, do not intend to register to vote, did not vote, etc.).

To determine if a voter is identified as a Democrat or Republican, we identified party affiliation from pre election survey data. In order to have the most complete view of Political party identification, we used Political party variable with the most number of records for Republican and Democrats and classified left leaning as Democrats while right leaning as Republicans. Responses that could not be classified into Democrat or Republican (such as Independent and or "do not know" were excluded from our analysis). 

The numerical age was provided in the analysis for those responses between the age of 18-79. A second grouping of data for responses "80 or older" was excluded from our data set as exact age was not provided. In order to more accurately determine expected age of both parties, we avoid estimating or imputing data without having a relative expectation of accuracy. 

Segmenting for responses related to the age and party using the criteria above we end with 3,499 responses for Democrat and 2,991 responses for Republican in our study (6,490 total responses).

```{r, echo=FALSE}
age_distribution <- age_party %>%
  group_by(party) %>%
  summarize(count = n())

sum_row = data.frame(party = "Total", count = sum(age_distribution$count))
age_distribution <- rbind(age_distribution, sum_row)
            
colnames(age_distribution) <- c("Party", "Number of Samples")
knitr::kable(age_distribution, caption = "Sample Size of Democrats & Republicans Used in Study",
             align = "c")
```

Looking at the age distribution (top graph) of Democrats and Republicans in our study, it seems that Republicans skews to the right (older). Democrats have many more records in age 20-40 vs. Republicans. Democrats show 2 peaks for at age 40 and 60. Normalizing the data due to the higher number of Democrat records in our data, the skew towards older demographic is more pronounced (bottom graph). Overall, there is not a very notable difference in the distribution between the two parties.

```{r echo=FALSE, fig.align='center', fig.height=4, fig.width=6, message=FALSE, warning=FALSE}
## Plotting Age distribution for two parties - Histogram of Count

age_party_hist1 <- age_party %>% 
  ggplot() + 
  aes(x = age, fill = party) + 
  geom_histogram(position = 'dodge', alpha = 0.8, bins = 30) + 
  labs(
    title    = 'Age Distribution Among Democrats and Republicans',
    subtitle = 'Democrats have more records in younger age, Republican skews older ', 
    x        = 'Age',
    y        = 'Count of Observations', 
    fill     = 'Political Party'
  ) + 
  scale_fill_manual(values = c("blue", "red")) +
  theme_light()

## Histogram of density
age_party_hist2 <- age_party %>% 
  ggplot() + 
  aes(x = age, y = ..density..,fill = party) + 
  geom_histogram(position = 'dodge', alpha = 0.8, bins = 30) + 
  labs(
    x        = 'Age',
    y        = 'Density', 
    fill     = 'Political Party'
  ) + 
  scale_fill_manual(values = c("blue", "red")) +
  theme_light()


age_party_hist1 / age_party_hist2
```

In the boxplot below, we further summarize the interquartile age range of both parties. The lower quartile and median age for Republicans is higher than Democrats (older). Republicans have a higher concentration of records between the 50-75th percentile relative to Democrats where the quartiles are more evenly distributed between 25-50th percentile and 50th-75th. Democrats seem to have better voter coverage across the different age ranges.

```{r echo=FALSE, fig.align='center', fig.height=3, fig.width=6, message=FALSE, warning=FALSE}
# Plot box plot of two groups
election$party <- factor(election$party, 
                              levels = c("Democrat", "Republican"))
my_box <- age_party %>% 
  ggplot() +
  aes(x = party, y = age) +
  geom_boxplot(color = c("blue", "red")) +
  #geom_jitter(width = 0.2, alpha = 0.7) +
	labs(
    title    = 'Boxplot of Age Distribution Among Democrats and Republicans',
    subtitle = 'Democrats age is more evenly distributed versus Republicans', 
    x        = 'Political Party',
    y        = 'Age', 
    fill     = 'Party'
    ) +
  theme_light( )

my_box
```

## Most appropriate test 

Based on our stated question and study data, the most appropriate statistical test to conduct is a two sample, two tailed Welch t-test.

The study compares different groups: Republican and Democrats and they are independent of each other (not paired - based on different sample sizes of within our data). We will use a two tailed test in order to understand any difference in age between the groups - either older or younger relative to each group. We do not want to ignore any effect that would be statistically notable in one direction (in favor of another). 

**Assumptions:**

* Data is of a metric scale
  - Age is a measurable and on an interval sale. Therefore it is metric in nature. 
  - One can compare and say a person of age 50 is older than age 40.
* Independent and Identically Distributed (IID)
    - The methodology of the data collection seemed to be more strenuous and mixed (Web, Phone, Zoom) in previous years due to COVID as well with several attempts needed and higher bounties placed on non responses. 
      - This could lead to potentially skewed data with mixed respondent motivation based on 1) free time to participate in survey and 2) motivation/need for survey response fees. Certain demographics/age groups (such as retired folks) could be more prone to respond and bias the results.
  - The target population is a cross section of 231 million US citizens age 18 or order
  - 2020 ANES sample is based on a random draw from US across 50 states with equal probability
    - The sampling methodology design accounts for sample bias across states.

* No major deviations from normality 
  - From the histogram plot of age and Political party, we do not see any major deviations from normality.
  - Given the sample size of our data (2.5K+ records for each party) we can use the central limit theorem to assume sample mean will converge to a normal distribution

Given the data and the research question, we form our hypothesis:

**Null Hypothesis:** The average age of Democratic voters *is equal* to the average age of Republican voters
$$H_o : \mu_1 = \mu_2$$
**Alternative Hypothesis:** The average age of Democratic voters *is not equal* to the average age of Republican voters
$$H_a : \mu_1 \neq \mu_2$$


**Rejection Criteria:**

$$p-value < 0.05$$
Using a two tailed t-test with p-value of 0.05, we proceed to conduct the t-test.

The conclusion from the experiment should not be interpreted as a casual inference but rather observational. The experiment can provide information regarding expected ages from the two parties based on the data but cannot be interpreted as age causing an effect on political association. The results of the test cannot provide insight on the factors that make people associate with one party or another. The test is merely an observation on the differences average expected age of Democrats and Republicans in the 2020 election.

## Test, results and interpretation

```{r echo=TRUE}
## Perform t-test between two groups
t.test(age~party, data = age_party)
```

From the t-test conducted, there is statistically significant evidence (p-value below 0.05) to suggest that the average age of a Democratic voters is not equal to that of a Republican voters. We would reject the null hypothesis from a statistical viewpoint based on our test criteria above.

```{r include=FALSE}
cohen.d(age~party, data = age_party)
# Result: d estimate: -0.1806938 (negligible)
```

From a practical viewpoint, the difference of 3 years is not that significant in that the viewpoints, political issues of interest, and lifestage perspective is not significantly different among adults 49 versus 52 years of age. The calculated Cohen's D at -0.18 is also at negligible level.

Beyond the expected voter age provided by the test, there is evidence to show (as seen in the Boxplot of Age Distribution Among Democrats and Republicans) the makeup of Democratic voters in our sample has more records in the younger age range. These types of insights can help inform party decisions. To play on their existing advantage, Democrats should try to "market" policies more towards younger people if they want to attract more voters and support. Alternatively, Republicans should try aim their policies to ones that appeal to an older crowd.

Additionally, there is more opportunity for both parties more voter by appealing to younger people. The 18-29 voting eligible population has the lowest [voting ratio](https://www.census.gov/library/visualizations/2017/comm/voting-rates-age.html). This highly coveted demographic is difficult but not impossible to attract. Younger voters may be harder to engage, but older voters are reliable to show up and vote (as seen through our sample data). Understanding the dynamics of the voter base is important in shaping the policies and political strategy of each party.


